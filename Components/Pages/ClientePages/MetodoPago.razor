@* @page "/metodo-pago"
@inject MetodoPagoService MetodoPagoService
@inject ReservasService ReservasService
@inject ToastService ToastService
@inject NavigationManager NavigationManager

<PageTitle>Método de Pago</PageTitle>

<EditForm Model="metodoPagoActual" OnValidSubmit="GuardarMetodoPago" FormName="NuevoMetodoPago">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="container mt-5 pt-5">
        <div class="card shadow-lg">
            <!-- Header -->
            <div class="card-header" style="background-color: #1C3144; color: white;">
                <h2 class="mb-0" style="font-family: 'Poppins', sans-serif;">
                    <strong>Registrar Método de Pago</strong>
                </h2>
            </div>

            <!-- Body -->
            <div class="card-body" style="background-color: #A2AEBB;">
                <!-- Campos de Entrada -->
                <div class="mb-3">
                    <label class="form-label" for="tipoPago" style="font-family: 'Poppins', sans-serif; color: #1C3144;">
                        <strong>Tipo de Pago</strong>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text" style="background-color: #FFBA08; color: white;">
                            <i class="bi bi-wallet2"></i>
                        </span>
                        <InputSelect id="tipoPago" @bind-Value="metodoPagoActual.Tipo" class="form-control" style="border: 1px solid #3F88C5;">
                            <option value="">Seleccione un tipo</option>
                            <option value="Tarjeta de crédito">Tarjeta de crédito</option>
                            <option value="Transferencia Bancaria">Transferencia Bancaria</option>
                            <option value="Pago en Línea">Pago en Línea</option>
                        </InputSelect>
                    </div>
                    <ValidationMessage For="(() => metodoPagoActual.Tipo)" />
                </div>

                <div class="mb-3">
                    <label class="form-label" for="fechaTransaccion" style="font-family: 'Poppins', sans-serif; color: #1C3144;">
                        <strong>Fecha de Transacción</strong>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text" style="background-color: #FFBA08; color: white;">
                            <i class="bi bi-calendar"></i>
                        </span>
                        <InputDate id="fechaTransaccion" @bind-Value="metodoPagoActual.FechaTransaccion" class="form-control" style="border: 1px solid #3F88C5;" />
                    </div>
                    <ValidationMessage For="(() => metodoPagoActual.FechaTransaccion)" />
                </div>

                <div class="mb-3">
                    <label class="form-label" for="monto" style="font-family: 'Poppins', sans-serif; color: #1C3144;">
                        <strong>Monto</strong>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text" style="background-color: #FFBA08; color: white;">
                            <i class="bi bi-cash"></i>
                        </span>
                        <InputNumber id="monto" @bind-Value="metodoPagoActual.Monto" class="form-control" style="border: 1px solid #3F88C5;" />
                    </div>
                    <ValidationMessage For="(() => metodoPagoActual.Monto)" />
                </div>

                <div class="mb-3">
                    <label class="form-label" for="reserva" style="font-family: 'Poppins', sans-serif; color: #1C3144;">
                        <strong>Reserva</strong>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text" style="background-color: #FFBA08; color: white;">
                            <i class="bi bi-file-earmark-check"></i>
                        </span>
                        <InputSelect id="reserva" @bind-Value="metodoPagoActual.ReservaId" class="form-control" style="border: 1px solid #3F88C5;">
                            <option value="">Seleccione una reserva</option>
                            @foreach (var reserva in reservasDisponibles)
                            {
                                <option value="@reserva.ReservaId">Reserva #@reserva.ReservaId</option>
                            }
                        </InputSelect>
                    </div>
                    <ValidationMessage For="(() => metodoPagoActual.ReservaId)" />
                </div>

                <div class="mb-3">
                    <label class="form-label" for="estado" style="font-family: 'Poppins', sans-serif; color: #1C3144;">
                        <strong>Estado de Transacción</strong>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text" style="background-color: #FFBA08; color: white;">
                            <i class="bi bi-shield-check"></i>
                        </span>
                        <InputSelect id="estado" @bind-Value="metodoPagoActual.EstadoTransaccion" class="form-control" style="border: 1px solid #3F88C5;">
                            <option value="">Seleccione un estado</option>
                            <option value="Aprobada">Aprobada</option>
                            <option value="Rechazada">Rechazada</option>
                            <option value="Pendiente">Pendiente</option>
                        </InputSelect>
                    </div>
                    <ValidationMessage For="(() => metodoPagoActual.EstadoTransaccion)" />
                </div>

                <div class="mb-3">
                    <label class="form-label" for="proveedor" style="font-family: 'Poppins', sans-serif; color: #1C3144;">
                        <strong>Proveedor de Pago</strong>
                    </label>
                    <div class="input-group">
                        <span class="input-group-text" style="background-color: #FFBA08; color: white;">
                            <i class="bi bi-building"></i>
                        </span>
                        <InputText id="proveedor" @bind-Value="metodoPagoActual.ProveedorPago" class="form-control" style="border: 1px solid #3F88C5;" />
                    </div>
                    <ValidationMessage For="(() => metodoPagoActual.ProveedorPago)" />
                </div>

                <!-- Botón Guardar -->
                <div class="mb-3 text-center">
                    <button type="submit" class="btn" style="background-color: #FF9F1C; color: white; width: 150px; font-size: 18px;">
                        Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>
</EditForm>

@code {
    private MetodoPago metodoPagoActual { get; set; } = new MetodoPago();
    private List<Reserva> reservasDisponibles = new List<Reserva>();

    protected override async Task OnInitializedAsync()
    {
        reservasDisponibles = await ReservasService.ObtenerTodasLasReservas();
    }

    private async Task GuardarMetodoPago()
    {
        try
        {
            var exito = await MetodoPagoService.AgregarMetodoPago(metodoPagoActual);

            if (exito)
            {
                ToastService.ShowSuccess("Método de pago registrado correctamente.");
                NavigationManager.NavigateTo("/metodos-pago");
            }
            else
            {
                ToastService.ShowError("Error al registrar el método de pago.");
            }
        }
        catch (Exception ex)
        {
            ToastService.ShowError($"Error: {ex.Message}");
        }
    }
}
 *@